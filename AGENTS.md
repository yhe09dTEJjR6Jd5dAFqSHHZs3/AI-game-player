编写一个单文件、无注释的Python脚本，实现通用游戏AI。

开发环境与约束：
语言与库：Python 3.13.9，PyTorch 2.9.0。
系统兼容：适配任意硬件配置的Windows 11。

文件约束：
仅输出一个.py文件，代码中不包含任何注释。
严禁安装除Python库以外的任何外部软件。
所有生成文件仅限于Desktop\GameAI及其子文件夹。
PyTorch兼容性修正：代码中必须使用torch.amp.GradScaler('cuda', args...)替代已弃用的torch.cuda.amp.GradScaler。
目录结构
程序启动时自动检查并创建以下路径（如果不存在）：
根目录：Desktop\GameAI
模型目录：Desktop\GameAI\models（启动时自动检查，若缺失则在本地生成初始模型文件）。
经验池目录：Desktop\GameAI\experience

核心功能模块

1. 全局自适应控制
截图频率自适应：基于CPU、内存、GPU、显存的实时占用率，动态调整截图频率（0Hz~120Hz）。
全局控制：用户按下ESC键时，立即终止程序。
窗口适应性：支持用户在运行期间任意调整目标窗口（窗口A）及主程序窗口的大小和位置。

2. 主程序窗口
越美观越好。
截图频率、窗口A的名称/尺寸/实时画面/是否可见且完整。
CPU、内存、GPU、显存实时占用率、按钮、数值识别列表。

3. 状态机与工作流

阶段A：初始化
用户选择窗口（定义为“窗口A”）。
用户选择窗口后，若一切就绪，切换至学习模式。

阶段B：学习模式
行为：持续记录用户在窗口A上的鼠标操作及窗口A画面，存入经验池（不记录键盘）。
遮挡处理：若窗口A被遮挡或不可见，暂停记录，直到窗口A再次可见且完整。
模式切换（自动）：检测到全局无键鼠操作持续10秒 -> 切换至训练模式。

功能交互：

“识别”按钮：
点击后暂停记录，按钮变灰，进入识别流程。
识别逻辑：识别窗口A画面中的非负整数。
UI反馈：通过进度条和文本展示进度。完成时弹窗提示。
确认后：弹窗确认 -> 进度条归零 -> 按钮恢复 -> 识别结果显示在列表 -> 返回学习模式。
结果展示：在预览画面上用半透明矩形覆盖数值区域（每种数值对应唯一、持久且高区分度的颜色）。
列表设置：用户可对列表中的每个数值设置属性：越高越好/越低越好/变化小好/变化大好/无关/识别错误（包含防误触的解锁/锁定功能）。

“Sleep”按钮：
点击后暂停记录，“Sleep”变灰，“Get Up”可用，进入优化流程。
优化逻辑：基于经验池数据优化AI模型（需具备鲁棒性，即使数据极少也能成功）。
AI目标：
①根据学习模式的数据，理解控件位置、形态及用法。
②根据鼠标、窗口A画面、识别到的数据，学会玩游戏。
UI反馈：通过进度条和文本展示进度。
“Get Up”中断：优化期间点击“Get Up” -> 提前结束 -> 生成新模型 -> 进度条归零 -> 按钮状态复位 -> 返回学习模式。
自然完成：优化完成 -> 弹窗提示 -> 点击确认 -> 生成新模型 -> 进度条归零 -> 按钮状态复位 -> 返回学习模式。
注意：识别和优化期间，10秒自动切换规则不生效。

阶段 C：训练模式
行为：AI接管控制，在窗口A上输出鼠标操作（点击/长按/按住-拖动-释放，拖动路径可以很复杂）。
数据记录：持续记录AI的鼠标操作以及窗口A画面到经验池（需标记数据来源为AI，与用户操作区分）。
中断机制：检测到键盘操作 -> 停止AI操作 -> 切换回学习模式（不停止记录，仅切换操作来源）。
遮挡处理：若窗口A被遮挡或不可见，暂停输出和记录。
